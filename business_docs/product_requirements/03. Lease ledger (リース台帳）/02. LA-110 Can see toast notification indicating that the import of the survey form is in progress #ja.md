JIRA Story URL: https://moneyforward.atlassian.net/browse/LA-110

Related Epic URL: https://moneyforward.kibe.la/notes/318947  　

## User Stories

* The accountant would like to see the progress when the survey form is imported.
  This is because imports may involve large amounts of data, and furthermore, the process is asynchronous, so it is important to have a correct understanding of the status of the import.
  Therefore, when a survey form is imported, a toast is displayed indicating the import process to start.

## Requirements

### Happy case

| No. | **Given**<br><span style="color: rgb(38, 38, 38)">Initial State</span> | **When**<br><span style="color: rgb(38, 38, 38)">Action</span> | **Then**<br><span style="color: rgb(38, 38, 38)">Expected Result</span> | 
| --- | --- | --- | --- |
| 1 | User opened the import modal | Click the import button<br><img src='/attachments/a0e2ccae-4b95-460b-b6f4-573ccfd9d988' title='image.png' alt='image' width='516' data-meta='{"width":516, "height":508}'> | "<span style="color: rgb(38, 38, 38)">インポート中です。/Importing</span>" toast is displayed<br><img src='/attachments/b5742806-2f91-485d-8b18-cd1dba4194d7' title='image.png' alt='image' width='2560' data-meta='{"width":2560,"height":1600}'> | 
| 2 | "Import in progress toast" is being displayed | Click the "x" button on the toast | \- Toast disappears<br>(Toast will continue to be displayed until the "x" button is clicked)<br>- Processing continues asynchronously | 
| 3 | "Import in progress toast" is being displayed | Users go to another screen | Toast will not be shown on another screen | 
| 4 | "Import in progress toast" is being displayed | Users go to another screen and come back or refresh the screen | Toast continues to be displayed | 
| 5 | "Import in progress toast" is being displayed | Click the "<span style="color: rgb(38, 38, 38)">中断/Cancel</span>" button on the toast<br><img src='/attachments/9e9a8a95-1458-4206-ad00-5558393fee37' title='image.png' alt='image' width='945' data-meta='{"width":945,"height":586}'> | "<span style="color: rgb(38, 38, 38)">インポートを中断しました。/</span>Survey form import is cancelled." toast is displayed<br>This toast will be displayed in 5 seconds<br><img src='/attachments/8d31f2bb-d6f0-4590-ae77-7e5e751f1d08' title='image.png' alt='image' width='2560' data-meta='{"width":2560,"height":1600}'> | 
| 6 | "Import in progress toast" is being displayed | Check the import button on the survey form screen | ・The import button is inactive (only for the person who performed the import operation) and there is a loading icon inside the button<br>・<span style="color: rgb(38, 38, 38)">If user closes toast, the loading indicator is still being shown</span><br><img src='/attachments/b61f2055-38a8-42d6-ab94-8a1384c13859' title='image.png' alt='image' width='939' data-meta='{"width":939,"height":592}'> | 

### Alternative case

| No. | **Given**<br><span style="color: rgb(38, 38, 38)">初期状態</span> | **When**<br><span style="color: rgb(38, 38, 38)">アクション</span> | **Then**<br><span style="color: rgb(38, 38, 38)">期待される結果</span> | 
| --- | --- | --- | --- |
| 1 | User opened tab 1/browser 1 to import Survey form.<br>The import process has not completed yet | User open another tab | The toast is only displayed in tab 1 | 

=======================================================================

# 調査票Excelのインポート進行中のToastを掲出する

## ⁠ユーザストーリー

* 経理担当者は、調査票をインポートしたときに、進行状況を確認したい。
  なぜなら、インポートは大量のデータを対象とする場合があり、さらに非同期で処理が行われるので、インポートの状況を正しく把握しておきたいため。
  そのため、調査票をインポートすると、インポート開始を伝えるToastを表示する。

## 要件

### Happy case

| No. | **Given**<br><span style="color: rgb(38, 38, 38)">初期状態</span> | **When**<br><span style="color: rgb(38, 38, 38)">アクション</span> | **Then**<br><span style="color: rgb(38, 38, 38)">期待される結果</span> | 
| --- | --- | --- | --- |
| 1 | ユーザーがインポートモーダルを開いている | インポートボタンをクリック<br><img src='/attachments/a0e2ccae-4b95-460b-b6f4-573ccfd9d988' title='image.png' alt='image' width='516' data-meta='{"width":516,"height":508}'> | 「インポート中です。」トーストが出る<br><img src='/attachments/5e524a7d-7df0-4795-b0d8-25c479078a2c' title='image.png' alt='image' width='2560' data-meta='{"width":2560,"height":1600}'> | 
| 2 | インポート中のトーストが出ている | トースト上の「×」ボタンをクリック | ・トーストが消える<br>（×ボタンをクリックするまで、Toastは表示され続ける）<br>・非同期で処理が継続される | 
| ⁠3 | インポート中のトーストが出ている | 別画面に行く | 調査票画面以外の画面でトーストは表示されない | 
| ⁠4 | インポート中のトーストが出ている | 別画面に行って戻ってきた時 or 画面更新をした場合 | Toastは表示され続ける | 
| ⁠5 | インポート中のトーストが出ている | トースト上の「中断」ボタンをクリック<br><img src='/attachments/e1b63282-c850-4cec-8579-c2cd588b5808' title='image.png' alt='image' width='945' data-meta='{"width":945,"height":586}'> | ・「インポートを中断しました。」トーストが出る<br>・5秒で自動でToastが消える<br><img src='/attachments/1e0cbcf8-69ab-43da-9f02-4debbf1f1d92' title='image.png' alt='image' width='2560' data-meta='{"width":2560,"height":1600}'> | 
| ⁠6 | インポート中のトーストが出ている | 調査票画面のインポートボタンをチェックする | ・（インポート操作した人だけ）インポートボタンが非活性になり、ボタン内にローディングアイコンが入っている<br>・インポート処理が完了するまでこのローディングインジケーターを表示する<br><img src='/attachments/a7b6dcd6-8222-4951-aef3-d32a6340af7c' title='image.png' alt='image' width='939' data-meta='{"width":939,"height":592}'> | 

### Alternative case

| No. | **Given**<br><span style="color: rgb(38, 38, 38)">初期状態</span> | **When**<br><span style="color: rgb(38, 38, 38)">アクション</span> | **Then**<br><span style="color: rgb(38, 38, 38)">期待される結果</span> | 
| --- | --- | --- | --- |
| 1 | ・タブ1で調査票画面を開いてインポートしている<br>・インポート処理が実行中 | 別タブで調査票画面を開く | 「インポート中です。」トーストはタブ1でしか出ない |
